<!DOCTYPE html>
<html lang="en">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Expense Reporting Form</title>
Â  Â  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
Â  Â  <style>
Â  Â  Â  Â  body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; padding: 20px; background-color: #f4f4f9; color: #333; }
Â  Â  Â  Â  .form-group { margin-bottom: 15px; }
Â  Â  Â  Â  label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 14px; }
Â  Â  Â  Â  input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 16px; }
Â  Â  Â  Â  input:focus { border-color: #1DB446; outline: none; box-shadow: 0 0 5px rgba(29, 180, 70, 0.2); }
Â  Â  Â  Â  button { width: 100%; padding: 15px; background-color: #1DB446; color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; margin-top: 10px; }
Â  Â  Â  Â  button:active { background-color: #169639; }
Â  Â  Â  Â  .loading { display: none; text-align: center; color: #666; margin-top: 20px; }
Â  Â  </style>
</head>
<body>

Â  Â  <div id="form-container">
Â  Â  Â  Â  <h3>Submit New Expense</h3>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  <label>Bill No.</label>
Â  Â  Â  Â  Â  Â  <input type="text" id="billNo" placeholder="Ex: SUYYMMNO">
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  <label>Item No.</label>
Â  Â  Â  Â  Â  Â  <input type="text" id="itemNo" placeholder="Ex: 1">
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  <label>Description</label>
Â  Â  Â  Â  Â  Â  <input type="text" id="desc" placeholder="Ex: à¹‚à¸„à¸£à¸‡à¹€à¸à¹‰à¸²à¸­à¸µà¹‰">
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  <label>Supplier</label>
Â  Â  Â  Â  Â  Â  <input type="text" id="supplier" placeholder="Ex: à¸Šà¹ˆà¸²à¸‡A">
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  <label>Installment No.</label>
Â  Â  Â  Â  Â  Â  <input type="Text" id="instNo" placeholder="Ex: 1/2">
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <div class="form-group">
Â  Â  Â  Â  Â  Â  <label>Amount</label>
Â  Â  Â  Â  Â  Â  <input type="number" step="0.01" id="amount" placeholder="0.00">
Â  Â  Â  Â  </div>

Â  Â  Â  Â  <button id="submitBtn" onclick="sendData()">Submit Expense</button>
Â  Â  Â  Â  <div id="loading" class="loading">Processing...</div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  // 1. Initialize LIFF
Â  Â  Â  Â  async function main() {
Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  Â  Â  await liff.init({ liffId: "2009003342-DR5kmBIl" }); // PASTE YOUR ID HERE
Â  Â  Â  Â  Â  Â  Â  Â  if (!liff.isLoggedIn()) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  liff.login();
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  } catch (err) {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("LIFF Initialization failed", err);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  main();

Â  Â  Â  Â  // 2. Send Data back to Chat
Â  Â  Â  Â  async function sendData() {
Â  Â  Â  Â  Â  Â  const bill = document.getElementById('billNo').value;
Â  Â  Â  Â  Â  Â  const item = document.getElementById('itemNo').value;
Â  Â  Â  Â  Â  Â  const desc = document.getElementById('desc').value;
Â  Â  Â  Â  Â  Â  const supplier = document.getElementById('supplier').value;
Â  Â  Â  Â  Â  Â  const inst = document.getElementById('instNo').value;
Â  Â  Â  Â  Â  Â  const amount = document.getElementById('amount').value;

Â  Â  Â  Â  Â  Â  // Simple Validation
Â  Â  Â  Â  Â  Â  if (!bill || !amount) {
Â  Â  Â  Â  Â  Â  Â  Â  alert("Please fill in at least the Bill No and Amount");
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  document.getElementById('submitBtn').style.display = 'none';
Â  Â  Â  Â  Â  Â  document.getElementById('loading').style.display = 'block';

Â  Â  Â  Â  Â  Â  // Generate a 3-character random Reference Code (e.g., A1B)
Â  Â  Â  Â  Â  Â  const refCode = Math.random().toString(36).substring(2, 5).toUpperCase();

Â  Â  Â  Â  Â  Â  const messageContent = `ðŸ“‹ *New Expense Submitted*\n\n` +
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â `â€¢ Bill No: ${bill}\n` +
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â `â€¢ Item No: ${item}\n` +
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â `â€¢ Desc: ${desc}\n` +
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â `â€¢ Supplier: ${supplier}\n` +
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â `â€¢ Installment: ${inst}\n` +
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â `â€¢ Amount: à¸¿${amount}\n`
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â `â€¢ Ref: ${refCode}`;

Â  Â  Â  Â  Â  Â  try {
Â  Â  Â  Â  // Send BOTH messages in one single array
Â  Â  Â  Â  await liff.sendMessages([
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  type: 'text',
Â  Â  Â  Â  Â  Â  Â  Â  text: messageContent
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  Â  type: 'text',
Â  Â  Â  Â  Â  Â  Â  Â  text: refCode // Separate text reply as requested
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  ]);
Â  Â  Â  Â Â 
Â  Â  Â  Â  liff.closeWindow();
Â  Â  Â  Â  Â  Â  Â  Â  liff.closeWindow(); // Closes form after submission
Â  Â  Â  Â  Â  Â  } catch (error) {
Â  Â  Â  Â  Â  Â  Â  Â  alert("Error sending message: " + error.message);
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('submitBtn').style.display = 'block';
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('loading').style.display = 'none';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  </script>
</body>
</html>
